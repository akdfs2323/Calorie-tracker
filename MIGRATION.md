# üîÑ Migration: Gemini ‚Üí Hugging Face

## ‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ **Hugging Face API** ‡πÅ‡∏ó‡∏ô Google Gemini ‡πÅ‡∏•‡πâ‡∏ß

---

## üéØ ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô?

### Hugging Face (‡πÉ‡∏´‡∏°‡πà) ‚úÖ
- ‚úÖ **‡∏ü‡∏£‡∏µ 100%** - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏•‡∏¢
- ‚úÖ **‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï**
- ‚úÖ **1,000 requests/‡∏ß‡∏±‡∏ô** (‡∏°‡∏≤‡∏Å‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
- ‚úÖ **Setup ‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤** - ‡πÅ‡∏Ñ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á token
- ‚úÖ **‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£** - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ quota

### Gemini (‡πÄ‡∏Å‡πà‡∏≤) ‚ùå
- ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï (‡πÅ‡∏°‡πâ Free tier)
- ‚ö†Ô∏è Quota ‡∏à‡∏≥‡∏Å‡∏±‡∏î
- ‚ö†Ô∏è Setup ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
- ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏°‡∏µ Error 500

---

## üìã ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ

### 1. Dependencies
```json
// ‡πÄ‡∏Å‡πà‡∏≤
"@google/generative-ai": "^0.21.0"

// ‡πÉ‡∏´‡∏°‡πà
"@huggingface/inference": "^2.6.4"
```

### 2. Environment Variables
```env
# ‡πÄ‡∏Å‡πà‡∏≤
GEMINI_API_KEY=xxx

# ‡πÉ‡∏´‡∏°‡πà
HUGGINGFACE_API_KEY=hf_xxx
```

### 3. AI Library
```
‡πÄ‡∏Å‡πà‡∏≤: lib/gemini.ts
‡πÉ‡∏´‡∏°‡πà: lib/huggingface.ts
```

### 4. AI Models
**Food Analysis:**
- ‡πÄ‡∏Å‡πà‡∏≤: Gemini 1.5 Flash
- ‡πÉ‡∏´‡∏°‡πà: Salesforce BLIP + Food Database

**Chat:**
- ‡πÄ‡∏Å‡πà‡∏≤: Gemini 1.5 Flash
- ‡πÉ‡∏´‡∏°‡πà: Llama 3.2-3B-Instruct

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡πÉ‡∏´‡∏°‡πà)

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:

1. **Extract project**
```bash
tar -xzf calorie-tracker.tar.gz
cd calorie-tracker
```

2. **Install dependencies**
```bash
npm install
```

3. **Get Hugging Face token** (2 ‡∏ô‡∏≤‡∏ó‡∏µ)
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://huggingface.co/settings/tokens
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á token ‡πÉ‡∏´‡∏°‡πà
   - Copy token

4. **Setup .env.local**
```bash
cp .env.local.template .env.local
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå .env.local ‡πÉ‡∏™‡πà token
```

5. **Run!**
```bash
npm run dev
```

---

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡πÉ‡∏ä‡πâ Gemini ‡∏≠‡∏¢‡∏π‡πà):

1. **‡∏•‡∏ö dependencies ‡πÄ‡∏Å‡πà‡∏≤**
```bash
npm uninstall @google/generative-ai
npm install @huggingface/inference
```

2. **‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå**
   - ‡∏•‡∏ö `lib/gemini.ts`
   - ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î `lib/huggingface.ts` ‡πÉ‡∏´‡∏°‡πà
   - API routes ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

3. **‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó .env.local**
```env
# ‡πÄ‡∏≠‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å
GEMINI_API_KEY=xxx

# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
HUGGINGFACE_API_KEY=hf_xxx
```

4. **Restart server**
```bash
npm run dev
```

---

## ü§ñ AI Models ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### 1. Salesforce/blip-image-captioning-large
- **‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£
- **Output**: ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**: "a bowl of fried rice with chicken"

### 2. Meta Llama 3.2-3B-Instruct
- **‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: Chatbot ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤
- **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö**: ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- **Context**: ‡∏à‡∏≥‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤

### 3. Food Database (Built-in)
- **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**: 30+ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£
- **‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°**: ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏Å‡∏•
- **‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**: Match ‡∏Ñ‡∏≥‡∏à‡∏≤‡∏Å BLIP ‚Üí ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà

---

## üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥

### Food Analysis:
- **BLIP**: ~85% ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
- **Nutrition Database**: ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
- **Tips**: ‡∏¢‡∏¥‡πà‡∏á‡∏£‡∏π‡∏õ‡∏ä‡∏±‡∏î ‡∏ú‡∏•‡∏¢‡∏¥‡πà‡∏á‡πÅ‡∏°‡πà‡∏ô

### Chat:
- **Llama 3.2**: ‡∏ï‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ
- **Context Aware**: ‡∏à‡∏≥‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ 5 ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
- **Response Time**: 2-5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

---

## üé® ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á

### 1. Food Recognition
- ‚úÖ ‡πÉ‡∏ä‡πâ BLIP (SOTA model)
- ‚úÖ Database ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢ 15+ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
- ‚úÖ Fallback ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£

### 2. Nutrition Estimation
- ‚úÖ ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‚úÖ ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢

### 3. Chat Thai Support
- ‚úÖ System prompt ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢
- ‚úÖ Response ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏ó‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ

---

## üêõ Known Issues & Solutions

### Issue: "Model is loading"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Model cold start
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏£‡∏≠ 10-30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà

### Issue: "Rate limit exceeded"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ‡πÄ‡∏Å‡∏¥‡∏ô 1,000 requests/‡∏ß‡∏±‡∏ô
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏£‡∏≠ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏û‡πÄ‡∏Å‡∏£‡∏î Pro

### Issue: "401 Unauthorized"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Token ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏™‡∏£‡πâ‡∏≤‡∏á token ‡πÉ‡∏´‡∏°‡πà

---

## üìà Performance Comparison

| Metric | Gemini | Hugging Face |
|--------|--------|--------------|
| **‡∏£‡∏≤‡∏Ñ‡∏≤** | ‡∏ü‡∏£‡∏µ (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ö‡∏±‡∏ï‡∏£) | ‡∏ü‡∏£‡∏µ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ |
| **Setup Time** | 5 ‡∏ô‡∏≤‡∏ó‡∏µ | 2 ‡∏ô‡∏≤‡∏ó‡∏µ |
| **Quota/‡∏ß‡∏±‡∏ô** | ~60 requests | 1,000 requests |
| **Response Time** | 1-3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ | 2-5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ |
| **‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢** | ‡∏î‡∏µ‡∏°‡∏≤‡∏Å | ‡∏î‡∏µ |
| **‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥** | ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å | ‡∏™‡∏π‡∏á |

---

## ‚úÖ Checklist ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡πâ‡∏ß:

- [x] `package.json` - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô dependency
- [x] `lib/huggingface.ts` - ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà
- [x] `app/api/analyze-food/route.ts` - import ‡πÉ‡∏´‡∏°‡πà
- [x] `app/api/chat/route.ts` - import ‡πÉ‡∏´‡∏°‡πà
- [x] `.env.local.template` - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
- [x] `README.md` - ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- [x] `QUICKSTART.md` - ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡∏°‡πà
- [x] `HUGGINGFACE_GUIDE.md` - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà

---

## üéâ ‡∏™‡∏£‡∏∏‡∏õ

### ‡πÄ‡∏î‡∏¥‡∏° (Gemini):
```
‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï ‚Üí Quota ‡∏ô‡πâ‡∏≠‡∏¢
```

### ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (Hugging Face):
```
‡∏á‡πà‡∏≤‡∏¢ ‚Üí ‡∏ü‡∏£‡∏µ‡∏à‡∏£‡∏¥‡∏á ‚Üí Quota ‡πÄ‡∏¢‡∏≠‡∏∞ ‚Üí ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
```

**Migration ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå! üéä**

---

## üìû ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠?

‡∏≠‡πà‡∏≤‡∏ô `HUGGINGFACE_GUIDE.md` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

**Happy coding with Hugging Face! ü§ó**
